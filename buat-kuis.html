<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Buat Pertanyaan Baru â€” Komunitas Ceria</title>
  <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;700;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#fff8f3; --card:#ffffff; --accent1:#ff8a80; --accent2:#ffd180; --accent3:#8c9eff; --accent4:#80d8ff; --muted:#6b6b6b;
      --glass: rgba(255,255,255,0.7);
    }
    *{box-sizing:border-box}
    body{font-family:'Baloo 2',sans-serif;margin:0;background:linear-gradient(135deg,var(--accent4), #e8f5e9); min-height:100vh; padding:15px;}
    .wrap{max-width:900px;margin:0 auto}
    header{display:flex;gap:12px;align-items:center;margin-bottom:15px;flex-wrap:wrap}
    header .logo{background:var(--card);padding:12px;border-radius:16px;box-shadow:0 6px 20px rgba(0,0,0,0.08);display:flex;align-items:center;gap:10px}
    header h1{margin:0;font-size:1.3rem;color:#263238}
    header p{margin:0;color:var(--muted);font-size:0.9rem}
    .card{background:var(--card);border-radius:16px;padding:18px;box-shadow:0 8px 25px rgba(0,0,0,0.08);margin-bottom:14px}
    .grid{display:grid;grid-template-columns:1fr 320px;gap:14px}
    form .row{display:flex;gap:10px;margin-bottom:12px;flex-wrap:wrap}
    label{display:block;font-weight:800;margin-bottom:6px;color:#263238}
    input[type=text], input[type=url], input[type=number], textarea, select{
      width:100%;padding:10px;border-radius:10px;border:2px solid rgba(0,0,0,0.06);
      background:linear-gradient(180deg, rgba(255,255,255,0.9), rgba(250,250,250,0.95));font-size:1rem
    }
    textarea{min-height:70px;resize:vertical}
    .section-title{font-weight:900;color:#37474f;margin-bottom:10px}
    .btn{display:inline-block;padding:10px 14px;border-radius:12px;border:none;background:var(--accent3);color:white;font-weight:800;cursor:pointer;font-size:0.95rem}
    .btn.ghost{background:transparent;border:2px dashed rgba(0,0,0,0.08);color:#263238}
    .answer-card{border-radius:12px;padding:10px;border:3px solid rgba(0,0,0,0.04);
      background:linear-gradient(180deg, rgba(255,255,255,0.8), rgba(250,250,250,0.95));margin-bottom:8px;position:relative;}
    .choices{display:grid;gap:8px}
    .choice-row{display:flex;gap:8px;align-items:flex-start;flex-wrap:wrap; padding-right: 30px;}
    .choice-row input[type=text]{flex:1}
    .choice-reason{width:100%}
    .submit-row{display:flex;justify-content:space-between;align-items:center;gap:10px;margin-top:14px;flex-wrap:wrap}
    .btn-submit{background:linear-gradient(90deg,var(--accent1),#ffb74d);padding:12px 18px;border-radius:12px;border:none;color:white;font-weight:900;font-size:1rem;cursor:pointer}
    .btn-submit:disabled { background: #ccc; cursor: not-allowed; }
    .btn-neutral{background:#eeeeee;color:#333;border-radius:10px;padding:10px 12px;border:none}
    .note{font-size:0.9rem;color:var(--muted);margin-top:6px}
    .btn-remove-choice {
        position: absolute;
        top: 5px;
        right: 5px;
        background: transparent;
        border: none;
        color: #ff8a80;
        cursor: pointer;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1;
        padding: 0 8px;
    }
    .btn-remove-choice:hover {
        color: #c62828;
    }
    @media(max-width:780px){.grid{grid-template-columns:1fr}.right-column{order:-1}}
    .message{padding:10px;border-radius:10px;margin-top:10px;font-weight:800;font-size:0.9rem}
    .message.success{background:#e8f5e9;color:#1b5e20}
    .message.error{background:#ffebee;color:#b71c1c}
    .preview-media{border-radius:10px;padding:8px;border:1px dashed rgba(0,0,0,0.06);min-height:48px;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,rgba(255,255,255,0.98),rgba(250,250,250,0.98))}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">
        <svg width="36" height="36" viewBox="0 0 24 24" fill="none"><rect width="24" height="24" rx="6" fill="#FF8A80"/><path d="M6 12h12M12 6v12" stroke="#fff" stroke-width="1.5"/></svg>
        <div>
          <h1>Buat Pertanyaan Baru</h1>
          <p>Isi detail soal, media, dan jawaban di bawah ini.</p>
        </div>
      </div>
    </header>
    <div class="grid">
      <div>
        <form id="question-form" class="card" autocomplete="off">
          <div>
            <div class="section-title">Informasi Soal</div>
            <div class="row">
              <div style="flex:1">
                <label for="pertanyaan-teks">Tulis Pertanyaan</label>
                <textarea id="pertanyaan-teks" placeholder="Contoh: Siapa proklamator kemerdekaan RI?"></textarea>
              </div>
            </div>

            <div class="row">
              <div style="flex:1">
                <label for="kategori-pilihan">Kategori Mata Pelajaran</label>
                <select id="kategori-pilihan">
                  <option value="">-- Pilih Mata Pelajaran --</option>
                  <option value="matematika">Matematika</option>
                  <option value="bahasa_indonesia">Bahasa Indonesia</option>
                  <option value="bahasa_inggris">Bahasa Inggris</option>
                  <option value="ipa">Ilmu Pengetahuan Alam</option>
                  <option value="agama_islam">Agama Islam</option>
                  <option value="ips">Ilmu Sosial</option>
                  <option value="sejarah">Sejarah</option>
                  <option value="pkn">Kewarganegaraan</option>
                  <option value="basa_sunda">Basa Sunda</option>
                  <option value="olahraga">Olahraga</option>
                  <option value="seni">Seni</option>
                  <option value="campuran_seru">Campuran Seru</option>
                </select>
              </div>
              <div style="width:200px">
                <label for="tipe-soal">Tipe Soal</label>
                <select id="tipe-soal">
                  <option value="pilihan_ganda">Pilihan Ganda</option>
                  <option value="esai">Esai</option>
                  <option value="pencocokan">Pencocokan</option>
                  <option value="susun_kata">Susun Kata</option>
                  <option value="multi_benar">Beberapa Jawaban Benar</option>
                  <option value="benar_salah">Benar / Salah</option>
                  <option value="tts_mini">TTS Mini</option>
                </select>
              </div>
            </div>
            
            <div class="row">
                <div style="flex:1">
                    <label for="github-repo-url">URL Repository GitHub (Opsional)</label>
                    <input type="url" id="github-repo-url" placeholder="https://github.com/username/repository">
                </div>
            </div>

            <hr style="border:none;height:10px;background:linear-gradient(90deg,var(--accent2),transparent);border-radius:6px;margin:10px 0">

            <div class="section-title">Media Tambahan (Gambar/Audio)</div>
            <div style="display:flex;gap:12px;align-items:center;margin-bottom:10px;flex-wrap:wrap">
              <div style="flex:1; min-width:200px;">
                <p class="note" style="margin-top:0;">Anda dapat mengunggah file ke Cloudinary (perlu diatur dalam kode) atau menggunakan URL langsung dari GitHub.</p>
              </div>
              <div style="width:220px">
                <label>Preview Media</label>
                <div id="preview-media" class="preview-media">Tidak ada media</div>
              </div>
            </div>

            <div style="display:flex;gap:12px;margin-bottom:10px;align-items:flex-start;flex-wrap:wrap">
              <div style="flex:1;min-width:220px">
                <label>Upload Gambar / Pilih file</label>
                <input type="file" id="file-image" accept="image/*" />
                <div style="margin-top:8px;display:flex;gap:8px">
                  <button type="button" id="upload-image-btn" class="btn">Upload ke Cloudinary</button>
                  <button type="button" id="use-github-image" class="btn ghost">Gunakan URL GitHub</button>
                </div>
                <input type="url" id="github-image-url" placeholder="Tempel URL gambar dari repo GitHub (opsional)" style="margin-top:8px" />
              </div>

              <div style="flex:1;min-width:220px">
                <label>Upload Audio / Pilih file</label>
                <input type="file" id="file-audio" accept="audio/*" />
                <div style="margin-top:8px;display:flex;gap:8px">
                  <button type="button" id="upload-audio-btn" class="btn">Upload Audio ke Cloudinary</button>
                  <button type="button" id="use-github-audio" class="btn ghost">Gunakan URL GitHub</button>
                </div>
                <input type="url" id="github-audio-url" placeholder="Tempel URL audio dari repo GitHub (opsional)" style="margin-top:8px" />
              </div>
            </div>

            <hr style="margin:12px 0;border:none;height:1px;background:linear-gradient(90deg,transparent,rgba(0,0,0,0.06),transparent)">

            <div id="dynamic-area"></div>

            <div class="submit-row">
              <button type="button" id="btn-preview" class="btn-neutral">Pratinjau</button>
              <div style="display:flex;gap:12px">
                <button type="button" id="btn-reset" class="btn-neutral">Reset</button>
                <button type="submit" id="btn-save" class="btn-submit">Simpan Pertanyaan</button>
              </div>
            </div>

            <div id="form-message" class="message" style="display:none"></div>
          </div>
        </form>
      </div>

      <aside class="right-column">
        <div class="card">
          <div class="section-title">Status</div>
          <div id="quota-display" class="note" style="font-weight:bold; margin-bottom:10px;">Memeriksa kuota...</div>
          <hr>
          <div class="section-title">Panduan singkat</div>
          <div class="hint">â€¢ Untuk Esai: pisahkan variasi jawaban dengan <code>||</code>, contoh: <em>soekarno || ir. soekarno || ir soekarno</em>
          <br>â€¢ Pilihan Ganda: pilih satu jawaban benar. Anda bisa menambah atau mengurangi pilihan (minimal 2, maksimal 4).
          <br>â€¢ Media: Upload ke Cloudinary (atur di kode) atau pakai URL GitHub langsung.</div>
          <hr>
          <div class="section-title">Preview Input</div>
          <div id="preview-card" class="answer-card small-muted">Pratinjau akan muncul di sini</div>
        </div>
      </aside>
    </div>
  </div>

  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    import { getFirestore, collection, doc, Timestamp, writeBatch, getDoc, getDocs, query } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // ---------- FIREBASE CONFIG ----------
    const firebaseConfig = { apiKey: "AIzaSyA6zXOerKvdPJTmBp5Y6R2yFsy98xLDsKc", authDomain: "forumwidara.firebaseapp.com", projectId: "forumwidara", storageBucket: "forumwidara.appspot.com", messagingSenderId: "216895655168", appId: "1:216895655168:web:59255f600fc3b3b44eb7e5" };
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // ---------- DOM & STATE ----------
    const tipeSoal = document.getElementById('tipe-soal');
    const dynamicArea = document.getElementById('dynamic-area');
    const previewMedia = document.getElementById('preview-media');
    const previewCard = document.getElementById('preview-card');
    const fileImage = document.getElementById('file-image');
    const fileAudio = document.getElementById('file-audio');
    const uploadImageBtn = document.getElementById('upload-image-btn');
    const uploadAudioBtn = document.getElementById('upload-audio-btn');
    const githubImageUrl = document.getElementById('github-image-url');
    const githubAudioUrl = document.getElementById('github-audio-url');
    const useGithubImage = document.getElementById('use-github-image');
    const useGithubAudio = document.getElementById('use-github-audio');
    const btnSave = document.getElementById('btn-save');
    const btnPreview = document.getElementById('btn-preview');
    const btnReset = document.getElementById('btn-reset');
    const formMessage = document.getElementById('form-message');
    const quotaDisplay = document.getElementById('quota-display');

    let currentUser = null;
    let userProfile = null;
    let uploadedImageUrl = null;
    let uploadedAudioUrl = null;
    const QUESTION_LIMIT = 5;

    // ---------- HELPERS ----------
    function showFormMessage(type, text, isPermanent = false) {
      formMessage.className = 'message ' + (type === 'ok' ? 'success' : 'error');
      formMessage.textContent = text;
      formMessage.style.display = 'block';
      if (!isPermanent) {
        setTimeout(() => formMessage.style.display = 'none', 5000);
      }
    }

    function setPreview(mediaType, url){ if(!url){ previewMedia.textContent='Tidak ada media'; return };
      if(mediaType==='image'){ previewMedia.innerHTML = `<img src="${url}" alt="preview" style="max-width:100%;border-radius:8px;">` }
      if(mediaType==='audio'){ previewMedia.innerHTML += `<audio controls src="${url}" style="width:100%;margin-top:8px"></audio>` }
    }

    async function uploadToCloudinary(file, resourceType='image'){
      // ---!!--- PENGATURAN CLOUDINARY ---!!---
      const CLOUDINARY_CLOUD_NAME = "ganti-dengan-cloud-name-anda"; 
      const CLOUDINARY_UPLOAD_PRESET = "ganti-dengan-upload-preset-anda";
      // ------------------------------------------
      
      if (CLOUDINARY_CLOUD_NAME === "ganti-dengan-cloud-name-anda") {
        throw new Error('Konfigurasi Cloudinary belum diatur di dalam kode. Harap edit file HTML ini.');
      }
      const url = `https://api.cloudinary.com/v1_1/${CLOUDINARY_CLOUD_NAME}/${resourceType}/upload`;
      const fd = new FormData();
      fd.append('file', file);
      if(CLOUDINARY_UPLOAD_PRESET && CLOUDINARY_UPLOAD_PRESET !== "ganti-dengan-upload-preset-anda") {
        fd.append('upload_preset', CLOUDINARY_UPLOAD_PRESET);
      }
      const res = await fetch(url, { method:'POST', body:fd });
      if(!res.ok) throw new Error('Upload gagal: '+res.statusText);
      const j = await res.json();
      return j.secure_url || j.url;
    }

    // ---------- EVENT LISTENERS (NON-FORM) ----------
    useGithubImage.addEventListener('click',()=>{ uploadedImageUrl = githubImageUrl.value.trim() || null; setPreview('image', uploadedImageUrl); showFormMessage('ok','Menggunakan URL gambar dari GitHub (atau URL langsung)'); });
    useGithubAudio.addEventListener('click',()=>{ uploadedAudioUrl = githubAudioUrl.value.trim() || null; setPreview('audio', uploadedAudioUrl); showFormMessage('ok','Menggunakan URL audio dari GitHub (atau URL langsung)'); });

    uploadImageBtn.addEventListener('click', async ()=>{
      if(!fileImage.files[0]){ showFormMessage('err','Pilih file gambar dulu'); return }
      try{ uploadImageBtn.disabled = true; uploadImageBtn.textContent='Uploading...';
        const url = await uploadToCloudinary(fileImage.files[0],'image');
        uploadedImageUrl = url; setPreview('image', url); showFormMessage('ok','Gambar terupload ke Cloudinary');
      }catch(e){ console.error(e); showFormMessage('err', e.message||'Gagal upload gambar') }finally{ uploadImageBtn.disabled=false; uploadImageBtn.textContent='Upload ke Cloudinary' }
    });

    uploadAudioBtn.addEventListener('click', async ()=>{
      if(!fileAudio.files[0]){ showFormMessage('err','Pilih file audio dulu'); return }
      try{ uploadAudioBtn.disabled = true; uploadAudioBtn.textContent='Uploading...';
        const url = await uploadToCloudinary(fileAudio.files[0],'video');
        uploadedAudioUrl = url; setPreview('audio', url); showFormMessage('ok','Audio terupload ke Cloudinary');
      }catch(e){ console.error(e); showFormMessage('err', e.message||'Gagal upload audio') }finally{ uploadAudioBtn.disabled=false; uploadAudioBtn.textContent='Upload Audio ke Cloudinary' }
    });
    
    // ---------- DYNAMIC FORM RENDERING ----------
    function renderPilihanGanda(){
      dynamicArea.innerHTML = `
        <div class="section-title">Pilihan Ganda â€” Isi jawaban & alasan per pilihan</div>
        <div class="note">Pilih <strong>satu</strong> jawaban yang benar. Anda bisa memiliki 2 sampai 4 pilihan.</div>
        <div class="choices" id="pg-choices-container">
          <div class="answer-card choice-row">
            <div style="width:36px;text-align:center; padding-top: 5px;">
              <input type="radio" name="pg-correct" class="pg-check" data-index="0" checked>
            </div>
            <div style="flex:1">
              <input type="text" class="jawaban" placeholder="Pilihan 1">
              <textarea class="jawaban-alasan" placeholder="Alasan jika pilihan ini BENAR atau mengapa SALAH (ringkas)"></textarea>
            </div>
            <button type="button" class="btn-remove-choice" title="Hapus Pilihan Ini">&times;</button>
          </div>
          <div class="answer-card choice-row">
            <div style="width:36px;text-align:center; padding-top: 5px;">
              <input type="radio" name="pg-correct" class="pg-check" data-index="1">
            </div>
            <div style="flex:1">
              <input type="text" class="jawaban" placeholder="Pilihan 2">
              <textarea class="jawaban-alasan" placeholder="Alasan jika pilihan ini BENAR atau mengapa SALAH (ringkas)"></textarea>
            </div>
            <button type="button" class="btn-remove-choice" title="Hapus Pilihan Ini">&times;</button>
          </div>
        </div>
        <div style="margin-top:12px;">
          <button type="button" id="add-choice-btn" class="btn ghost">+ Tambah Pilihan</button>
        </div>
      `;
    }

    function handleDynamicClicks(e) {
        const choicesContainer = document.getElementById('pg-choices-container');
        if (!choicesContainer) return;

        if (e.target && e.target.id === 'add-choice-btn') {
            const currentChoices = choicesContainer.querySelectorAll('.choice-row');
            if (currentChoices.length < 4) {
                const newIndex = currentChoices.length;
                const newChoiceHTML = `
                    <div class="answer-card choice-row">
                        <div style="width:36px;text-align:center; padding-top: 5px;">
                            <input type="radio" name="pg-correct" class="pg-check" data-index="${newIndex}">
                        </div>
                        <div style="flex:1">
                            <input type="text" class="jawaban" placeholder="Pilihan ${newIndex + 1}">
                            <textarea class="jawaban-alasan" placeholder="Alasan jika pilihan ini BENAR atau mengapa SALAH (ringkas)"></textarea>
                        </div>
                        <button type="button" class="btn-remove-choice" title="Hapus Pilihan Ini">&times;</button>
                    </div>
                `;
                choicesContainer.insertAdjacentHTML('beforeend', newChoiceHTML);
            }
            if (choicesContainer.querySelectorAll('.choice-row').length >= 4) {
                e.target.style.display = 'none';
            }
        }

        if (e.target && e.target.classList.contains('btn-remove-choice')) {
            const currentChoices = choicesContainer.querySelectorAll('.choice-row');
            if (currentChoices.length > 2) {
                e.target.closest('.choice-row').remove();
                const addBtn = document.getElementById('add-choice-btn');
                if(addBtn) addBtn.style.display = 'inline-block';

                choicesContainer.querySelectorAll('.choice-row').forEach((row, index) => {
                    row.querySelector('.pg-check').dataset.index = index;
                    row.querySelector('.jawaban').placeholder = `Pilihan ${index + 1}`;
                });
            } else {
                showFormMessage('err', 'Harus ada minimal 2 pilihan jawaban.');
            }
        }
    }

    function renderEsai(){ /* ... (kode tidak berubah) ... */ }
    function renderPencocokan(){ /* ... (kode tidak berubah) ... */ }
    function handlePencocokanClick(e) { /* ... (kode tidak berubah) ... */ }
    function renderSusunKata(){ /* ... (kode tidak berubah) ... */ }
    function renderMultiBenar(){ /* ... (kode tidak berubah) ... */ }
    function renderBenarSalah(){ /* ... (kode tidak berubah) ... */ }
    function renderTtsMini(){ /* ... (kode tidak berubah) ... */ }

    function renderDynamic(){
      const t = tipeSoal.value;
      if(t==='pilihan_ganda') renderPilihanGanda();
      else if(t==='esai') renderEsai();
      else if(t==='pencocokan') renderPencocokan();
      else if(t==='susun_kata') renderSusunKata();
      else if(t==='multi_benar') renderMultiBenar();
      else if(t==='benar_salah') renderBenarSalah();
      else if(t==='tts_mini') renderTtsMini();
    }
    
    // ---------- AUTH, PROFILE, & QUOTA CHECK ----------
    async function checkQuestionQuota(uid) {
        const creationLogRef = collection(db, 'userData', uid, 'questionCreationTimestamp');
        const q = query(creationLogRef);
        const querySnapshot = await getDocs(q);
        const creationCount = querySnapshot.size;
        const remaining = QUESTION_LIMIT - creationCount;

        quotaDisplay.textContent = `Kuota membuat soal: ${remaining > 0 ? remaining : 0} / ${QUESTION_LIMIT}`;
        
        if (creationCount >= QUESTION_LIMIT) {
            btnSave.disabled = true;
            btnSave.textContent = 'Kuota Habis';
            showFormMessage('err', `Anda telah mencapai batas ${QUESTION_LIMIT} pertanyaan. Kuota tidak dapat direset.`, true);
        } else {
            btnSave.disabled = false;
            btnSave.textContent = 'Simpan Pertanyaan';
        }
    }

    async function checkUserData(user){
      if(!user) return;
      try{
        const profileRef = doc(db,'profiles',user.uid);
        const profileSnap = await getDoc(profileRef);
        if(!profileSnap.exists() || !profileSnap.data().class){
          showFormMessage('err','Atur kelas di profilmu terlebih dahulu', true);
          btnSave.disabled = true;
          return;
        }
        userProfile = profileSnap.data();
        currentUser = user;
        await checkQuestionQuota(user.uid);
      }catch(e){ console.warn("Profile check error:",e); }
    }

    onAuthStateChanged(auth, async (user) => { if(user) await checkUserData(user); else window.location.href='index.html'; });

    // ---------- FORM SUBMIT LOGIC ----------
    document.getElementById('question-form').addEventListener('submit', async (e)=>{
      e.preventDefault();
      if(!currentUser || !userProfile || btnSave.disabled){ 
        showFormMessage('err','Tidak dapat menyimpan. Periksa status login dan kuota Anda.');
        return; 
      }
      
      const data = {
        untukKelas: userProfile.class,
        teksPertanyaan: document.getElementById('pertanyaan-teks').value.trim(),
        kategori: document.getElementById('kategori-pilihan').value || null,
        dibuatOleh: currentUser.uid,
        dibuatPada: Timestamp.now(),
        tipeSoal: tipeSoal.value,
        urlGambar: uploadedImageUrl || null,
        urlSuara: uploadedAudioUrl || null,
        urlRepoGithub: document.getElementById('github-repo-url').value.trim() || null
      };

      try{
        const t = tipeSoal.value;
        if(t==='pilihan_ganda'){
          // ... (logika pilihan ganda tidak berubah)
        } 
        // ... (blok else if lainnya tidak berubah)

        // Save to Firestore using a batch
        const batch = writeBatch(db);
        const questionRef = doc(collection(db,'pertanyaan'));
        batch.set(questionRef, data);

        // Log the creation for quota system
        const creationLogRef = doc(db, 'userData', currentUser.uid, 'questionCreationTimestamp', questionRef.id);
        batch.set(creationLogRef, { timestamp: Timestamp.now() });
        
        await batch.commit();
        showFormMessage('ok','Pertanyaan berhasil disimpan âœ…');
        
        document.getElementById('question-form').reset(); 
        uploadedImageUrl = null; 
        uploadedAudioUrl = null; 
        previewMedia.textContent='Tidak ada media'; 
        renderDynamic();

        // Re-check quota immediately after saving
        await checkQuestionQuota(currentUser.uid);

      }catch(err){ console.error(err); showFormMessage('err', err.message || 'Gagal menyimpan soal'); }
    });

    // ---------- PREVIEW & RESET ----------
    btnPreview.addEventListener('click', () => { /* ... (kode tidak berubah) ... */ });
    btnReset.addEventListener('click', ()=>{ document.getElementById('question-form').reset(); uploadedImageUrl=null; uploadedAudioUrl=null; previewMedia.textContent='Tidak ada media'; renderDynamic(); });
    
    // ---------- INITIAL & DYNAMIC EVENT SETUP ----------
    renderDynamic();
    dynamicArea.addEventListener('click', (e) => {
        handleDynamicClicks(e);
        handlePencocokanClick(e);
    });
    tipeSoal.addEventListener('change', renderDynamic);

  </script>
</body>
</html>


