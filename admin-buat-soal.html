<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin: Buat Soal Tantangan - Komunitas Ceria 2SD</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Baloo+2:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Baloo 2', sans-serif; margin: 0; background-color: #f4f6f8; color: #333; padding-bottom: 100px; }
        .container { max-width: 800px; margin: 30px auto; padding: 20px; }
        .page-header { text-align: center; margin-bottom: 30px; }
        .page-header h1 { font-size: 2.5rem; margin: 0; color: #4a5568; }
        .form-section { background-color: white; padding: 30px; border-radius: 20px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        h2 { margin-top: 0; border-bottom: 3px solid #e2e8f0; padding-bottom: 10px; color: #2d3748; }
        .input-group { margin-bottom: 20px; }
        .input-group label { display: block; margin-bottom: 8px; font-weight: 700; }
        .input-group input, .input-group textarea, .input-group select { width: 100%; padding: 12px; border-radius: 8px; border: 2px solid #cbd5e0; box-sizing: border-box; font-family: 'Baloo 2', sans-serif; font-size: 1rem; }
        .btn-submit { width: 100%; padding: 15px; border: none; background-color: #03a9f4; color: white; font-size: 1.2rem; font-weight: 800; border-radius: 10px; cursor: pointer; border-bottom: 4px solid #0288d1; margin-top: 20px; }
        .message { text-align: center; padding: 12px; border-radius: 8px; font-weight: 700; margin-top: 20px; display: none; }
        .message.success { background-color: #c6f6d5; color: #2f855a; }
        .message.error { background-color: #fed7d7; color: #c53030; }
        .tombol-beranda { position: fixed; bottom: 20px; right: 20px; background-color: #FFC107; color: #333; padding: 12px 20px; border-radius: 50px; display: flex; align-items: center; gap: 8px; font-size: 1.1rem; font-weight: 700; text-decoration: none; box-shadow: 0 4px 10px rgba(0, 0, 0, 0.15); transition: transform 0.2s ease, box-shadow 0.2s ease; z-index: 1000; }
        .tombol-beranda:hover { transform: translateY(-3px); box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2); }
    </style>
</head>
<body>
    <div class="container">
        <header class="page-header">
            <h1>Buat Soal Tantangan Baru üìù</h1>
        </header>

        <section class="form-section">
            <form id="question-form">
                <div class="input-group">
                    <label for="kategori">Kategori Soal</label>
                    <input type="text" id="kategori" placeholder="Contoh: matematika, ipa (samakan dengan di tantangan)" required>
                </div>
                <div class="input-group">
                    <label for="pertanyaan">Teks Pertanyaan</label>
                    <textarea id="pertanyaan" rows="3" required></textarea>
                </div>
                <div class="input-group">
                    <label>Pilihan Jawaban</label>
                    <input type="text" id="option1" placeholder="Teks Jawaban A" required style="margin-bottom: 10px;">
                    <input type="text" id="option2" placeholder="Teks Jawaban B" required style="margin-bottom: 10px;">
                    <input type="text" id="option3" placeholder="Teks Jawaban C" required style="margin-bottom: 10px;">
                    <input type="text" id="option4" placeholder="Teks Jawaban D" required>
                </div>
                 <div class="input-group">
                    <label for="jawaban">Jawaban yang Benar</label>
                    <select id="jawaban" required>
                        <option value="">-- Pilih Jawaban Benar --</option>
                        <option value="A">Jawaban A</option>
                        <option value="B">Jawaban B</option>
                        <option value="C">Jawaban C</option>
                        <option value="D">Jawaban D</option>
                    </select>
                </div>
                <button type="submit" class="btn-submit">Simpan Soal</button>
                <div id="message-box" class="message"></div>
            </form>
        </section>
    </div>
    <a href="index.html" class="tombol-beranda" title="Kembali ke Beranda"><span>üè†</span><span>Beranda</span></a>

<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

    // Ganti dengan konfigurasi Firebase Anda
    const firebaseConfig = {
        apiKey: "AIzaSyA6zXOerKvdPJTmBp5Y6R2yFsy98xLDsKc",
        authDomain: "forumwidara.firebaseapp.com",
        projectId: "forumwidara",
        storageBucket: "forumwidara.firebasestorage.app",
        messagingSenderId: "216895655168",
        appId: "1:216895655168:web:59255f600fc3b3b44eb7e5"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const mainForm = document.getElementById('question-form');
    const messageBox = document.getElementById('message-box');

    mainForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        const kategori = document.getElementById('kategori').value.toLowerCase();
        const pertanyaan = document.getElementById('pertanyaan').value;
        const pilihan1 = document.getElementById('option1').value;
        const pilihan2 = document.getElementById('option2').value;
        const pilihan3 = document.getElementById('option3').value;
        const pilihan4 = document.getElementById('option4').value;
        const jawabanIndex = document.getElementById('jawaban').value;
        
        if (!kategori || !pertanyaan || !pilihan1 || !pilihan2 || !pilihan3 || !pilihan4 || !jawabanIndex) {
            showMessage('error', 'Semua field harus diisi.');
            return;
        }

        const pilihan = [pilihan1, pilihan2, pilihan3, pilihan4];
        let jawabanBenarText = '';
        if(jawabanIndex === 'A') jawabanBenarText = pilihan1;
        else if (jawabanIndex === 'B') jawabanBenarText = pilihan2;
        else if (jawabanIndex === 'C') jawabanBenarText = pilihan3;
        else if (jawabanIndex === 'D') jawabanBenarText = pilihan4;


        // Data yang akan disimpan ke firestore
        const soalData = { 
            kategori: kategori, 
            pertanyaan: pertanyaan,
            pilihan: pilihan,
            // PERUBAHAN KEDUA: Menggunakan nama field "jawaban" agar konsisten
            jawaban: jawabanBenarText
        };
        
        try {
            // PERUBAHAN PERTAMA: Menyimpan ke koleksi "soal"
            await addDoc(collection(db, "soal"), soalData);
            
            showMessage('success', 'Soal baru berhasil disimpan!');
            mainForm.reset();
        } catch (error) {
            console.error("Gagal menyimpan soal:", error);
            showMessage('error', `Gagal menyimpan soal: ${error.message}`);
        }
    });

    function showMessage(type, text) {
        messageBox.className = `message ${type}`;
        messageBox.textContent = text;
        messageBox.style.display = 'block';
        setTimeout(() => { messageBox.style.display = 'none'; }, 4000);
    }
</script>
</body>
</html>

    
